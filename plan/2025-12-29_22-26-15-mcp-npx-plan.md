---
mode: plan
cwd: /Volumes/DATABASE/code/mcp/Design-Learn
task: Design-Learn v2.x MCP 一键启动与插件自动连接规划
complexity: complex
planning_method: builtin
created_at: 2025-12-29T22:26:15+08:00
---

# Plan: Design-Learn v2.x MCP 一键启动与插件自动连接

🎯 任务概述
在现有“统一服务 + 轻量客户端”的架构基础上，新增 MCP 的一键启动与客户端自动连接能力，目标是用户通过 npx 即可启动服务，安装 Chrome/VSCode 插件后能自动发现并连接本地服务，同时保留手动配置兜底。

📋 执行计划
1. 明确范围与里程碑：将 MCP 一键启动与自动连接能力拆分为 MVP/迭代清单，明确成功指标与依赖，输出验收口径。
2. 现有实现盘点与迁移策略：评估当前 design-learn-server、插件配置与启动流程的复用与改造成本，明确兼容路径与回滚策略。
3. 核心服务骨架落地：保持单进程服务入口与 REST/WS/MCP 基础链路稳定，补齐启动参数与可观测性基线。
4. 数据层与存储格式实施：确保 SQLite + 文件存储路径在 npx 启动场景下可配置与稳定复用。
5. 提取与分析流水线：统一 Playwright 抓取与浏览器插件导入路径，保持队列与进度推送稳定。
6. MCP 协议与 API 契约：完善 tools/resources/prompts 的注册与 SSE 传输，确保客户端可用与兼容策略稳定。
7. 客户端改造与联调：Chrome 插件负责采集上报并自动探测；VSCode 扩展提供服务管理与联动入口，形成配对与同步流程。
8. MCP 一键启动与分发：提供 npm 包与 npx 启动入口（默认端口/数据路径/鉴权可配置），支持快速启动与健康检查。
9. 插件自动连接体验：插件启动/打开设置时自动探测本地服务，未找到时提示启动并提供入口，手动 URL 作为兜底。
10. 测试与文档完善：补齐 npx 启动、插件自动连接、MCP 接入的测试与文档，形成发布清单与回滚策略。

⚠️ 风险与注意事项
- 浏览器扩展无法直接启动本地进程，需要通过 VSCode 或外部 CLI 间接启动。
- MCP 客户端对 SSE 行为与认证方式存在差异，需要兼容与回退策略。
- npx 场景下的数据目录与依赖路径需明确，避免破坏本地数据。

📎 参考
- `首版 PRD.md:60`
- `首版 PRD.md:286`
- `首版 PRD.md:435`
- `plan/2025-12-29_13-27-07-initial-prd-plan.md:15`
